{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://gcn.nasa.gov/schema/main/swift/bat/lightcurve.schema.json",
  "title": "swift.bat.lightcurve",
  "description": "GCN Notice schema for Swift BAT GRB lightcurve notices (packet types 63 and 76: SWIFT_BAT_GRB_LC and SWIFT_BAT_GRB_LC_PROC). The lightcurve notice is issued when the BAT ground software has accumulated sufficient data to generate a lightcurve FITS file for the trigger. Type=63 is the raw flight notice; type=76 is the ground-processed notice.",
  "type": "object",
  "allOf": [
    { "$ref": "https://gcn.nasa.gov/schema/main/gcn/notices/core/Alert.schema.json" },
    { "$ref": "https://gcn.nasa.gov/schema/main/gcn/notices/core/DateTime.schema.json" },
    { "$ref": "https://gcn.nasa.gov/schema/main/gcn/notices/core/Reporter.schema.json" },
    { "$ref": "https://gcn.nasa.gov/schema/main/gcn/notices/core/Event.schema.json" },
    { "$ref": "https://gcn.nasa.gov/schema/main/gcn/notices/core/Localization.schema.json" },
    { "$ref": "https://gcn.nasa.gov/schema/main/gcn/notices/core/GeoLocBase.schema.json" },
    { "$ref": "https://gcn.nasa.gov/schema/main/gcn/notices/core/Statistics.schema.json" },
    { "$ref": "https://gcn.nasa.gov/schema/main/gcn/notices/core/HardnessRatio.schema.json" },
    { "$ref": "https://gcn.nasa.gov/schema/main/gcn/notices/core/Duration.schema.json" }
  ],
  "properties": {

    "trigger_index": {
      "type": "integer",
      "description": "Row number in the BAT on-board flight software trigger table corresponding to the highest-significance successful trigger criterion. Derived from trig_index (bin[17])."
    },

    "spectral_lag": {
      "type": ["number", "null"],
      "description": "Spectral lag of the GRB in seconds — the time delay between the arrival of hard and soft photons. Not derivable from the BAT_GRB_LC binary packet; always null."
    },

    "lightcurve_fits_file": {
      "type": "string",
      "contentEncoding": "base64",
      "contentMediaType": "image/fits",
      "description": "Base64-encoded content of the BAT lightcurve FITS file. The raw binary packet (bin[22–38]) contains only the filename portion of the URL pointing to this file; the base64-encoded file content is populated during GCN ground processing."
    },

    "watchdog_timeout": {
      "type": "boolean",
      "description": "Indicates whether this BAT_GRB_LC notice was forced out early via the watchdog timeout mechanism rather than completing normally. Derived from misc bit 2^29."
    },

    "star_tracker_locked": {
      "type": "boolean",
      "description": "Indicates whether the StarTracker was locked at the time of the BAT trigger. True = locked; False = not locked (trigger is probably bogus). Derived from soln_status bit 2^10 (st_loss_lock) via lookup table. Only valid if misc bit 2^24 is set."
    }

  },

  "required": [
    "trigger_index",
    "spectral_lag",
    "lightcurve_fits_file",
    "watchdog_timeout",
    "star_tracker_locked"
  ],

  "additionalProperties": false
}